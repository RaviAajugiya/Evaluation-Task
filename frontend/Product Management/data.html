<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <!-- Include Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

    <style>
        #datatable th {
            width: 150px; /* Set your desired width */
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <div class="mb-3">
            <label for="pageSizeSelect" class="form-label">Page Size:</label>
            <select id="pageSizeSelect" class="form-select" aria-label="Default select example">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <!-- Add more options as needed -->
            </select>
        </div>
        
        <table id="datatable" class="table table-striped">
            <thead>
                <tr>
                    <th data-sort="partyId">
                        Party ID
                        <span class="sort-arrow">&#9650;</span>
                    </th>
                    <th data-sort="partyName">
                        Party Name
                        <span class="sort-arrow">&#9650;</span>
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- Table content will be dynamically generated here -->
            </tbody>
        </table>

        <nav aria-label="Page navigation">
            <ul class="pagination">
                <li class="page-item" id="prevPageBtn">
                    <a class="page-link" href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <li class="page-item" id="currentPage"></li>
                <li class="page-item" id="nextPageBtn">
                    <a class="page-link" href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>

    <script>
        $(document).ready(function () {
            var page = 1;
            var pageSize = $('#pageSizeSelect').val();
            var sortColumn = 'partyId';
            var sortOrder = 'asc';

            function fetchData() {
                $.ajax({
                    url: 'https://localhost:44309/api/data',
                    method: 'GET',
                    data: {
                        page: page,
                        pageSize: pageSize,
                        sortColumn: sortColumn,
                        sortOrder: sortOrder
                    },
                    success: function (data) {
                        $('#datatable tbody').empty();

                        $.each(data, function (index, item) {
                            $('#datatable tbody').append('<tr><td>' + item.partyId + '</td><td>' + item.partyName + '</td></tr>');
                        });

                        $('#currentPage').text('Page ' + page);
                        
                        // Update sort arrows
                        updateSortArrows();
                    },
                    error: function (error) {
                        console.error('Error fetching data from the API:', error);
                    }
                });
            }

            fetchData();

            $('#nextPageBtn').on('click', function () {
                page++;
                fetchData();
            });

            $('#prevPageBtn').on('click', function () {
                if (page > 1) {
                    page--;
                    fetchData();
                }
            });

            $('#datatable th').on('click', function () {
                var clickedColumn = $(this).data('sort');
                if (clickedColumn === sortColumn) {
                    sortOrder = sortOrder === 'asc' ? 'desc' : 'asc';
                } else {
                    sortColumn = clickedColumn;
                    sortOrder = 'asc';
                }
                fetchData();
            });

            $('#pageSizeSelect').on('change', function () {
                pageSize = $(this).val();
                fetchData();
            });
            function updateSortArrows() {
                $('#datatable th span.sort-arrow').html('');
                var arrow = sortOrder === 'asc' ? '&#9650;' : '&#9660;';
                $('#datatable th[data-sort="' + sortColumn + '"] span.sort-arrow').html(arrow);
            }
        });
    </script>
</body>

</html>
